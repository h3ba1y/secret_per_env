name: 'Build and Deploy to dev'

on:
  push:
    branches:
      - develop
      - master
      - qa

jobs:
  deploy-to-env:
    name: "deploy to environment"
    - uses: kanga333/variable-mapper@master
      with:
        key: "${{github.base_ref}}"
        map: |
          {
            "master": {
              "environment": "production"
            },
            "qa": {
              "environment": "staging"
            },
            "develop": {
              "environment": "dev"
            }
          }
    - uses: ./.github/workflows/test.yml
      secrets: inherit
      with:
        env: ${{ env.environment }}
